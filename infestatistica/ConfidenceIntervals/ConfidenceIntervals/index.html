<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../../../img/favicon.ico">
        <title>Intervalos de Confiança - Teaching Assistant</title>
        <link href="../../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">

        <script src="../../../js/jquery-1.10.2.min.js" defer></script>
        <script src="../../../js/bootstrap.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="../../..">Teaching Assistant</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="navitem">
                                <a href="../../.." class="nav-link">Home</a>
                            </li>
                            <li class="dropdown active">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Inferência à Estatística <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../info/" class="dropdown-item">Informações Gerais</a>
</li>
                                    
<li>
    <a href="../../LargeRandomSamples/LargeRandomSamples/" class="dropdown-item">Grandes Amostras</a>
</li>
                                    
<li>
    <a href="../../StatisticalInference/StatisticalInference/" class="dropdown-item">Introdução</a>
</li>
                                    
<li>
    <a href="../../PrioriPosteriori/PrioriPosteriori/" class="dropdown-item">Priori e Posteriori</a>
</li>
                                    
<li>
    <a href="../../ConjugateDistributions/ConjugateDistributions/" class="dropdown-item">Distribuições Conjugada e Estimador de Bayes</a>
</li>
                                    
<li>
    <a href="../../MaximumLikelihoodEstimator/MaximumLikelihoodEstimator/" class="dropdown-item">Estimador de Máxima Verossimilhança</a>
</li>
                                    
<li>
    <a href="../../SufficientStatistics/" class="dropdown-item">Estatísticas Suficientes</a>
</li>
                                    
<li>
    <a href="../../SamplingDistribution/SamplingDistribution/" class="dropdown-item">Distribuição Amostral</a>
</li>
                                    
<li>
    <a href="./" class="dropdown-item active">Intervalos de Confiança</a>
</li>
                                    
<li>
    <a href="../../BayesianAnalysisNormal/BayesianAnalysisNormal/" class="dropdown-item">Análise Bayesiana da Normal</a>
</li>
                                    
<li>
    <a href="../../UnbiasedEstimators/UnbiasedEstimators/" class="dropdown-item">Estimadores não enviesados</a>
</li>
                                    
<li>
    <a href="../../FisherInformation/FisherInformation/" class="dropdown-item">Informação de Fisher</a>
</li>
                                    
<li>
    <a href="../../TestingHypotheses/TestingHypotheses/" class="dropdown-item">Teste de Hipóteses</a>
</li>
                                    
<li>
    <a href="../../TestingHypothesesII/TestingHypothesesII/" class="dropdown-item">Teste de Hipóteses II</a>
</li>
                                    
<li>
    <a href="../../ExampleHypothesesTesting/ExampleHypothesesTesting/" class="dropdown-item">Exemplos Básicos Testes de Hipótese</a>
</li>
                                    
<li>
    <a href="../../TestsUniformlyPoweful/TestsUniformlyPoweful/" class="dropdown-item">Testes Uniformemente mais Poderosos</a>
</li>
                                </ul>
                            </li>
                            <li class="navitem">
                                <a href="../../../edo/info/" class="nav-link">Equações Diferenciais</a>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Álgebra Linear <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../../alglin/info/" class="dropdown-item">Informações Gerais</a>
</li>
                                    
<li>
    <a href="../../../alglin/files/monitoria4/monitoria4/" class="dropdown-item">Monitoria 4</a>
</li>
                                    
<li>
    <a href="../../../alglin/files/monitoria6/" class="dropdown-item">Monitoria 6</a>
</li>
                                    
<li>
    <a href="../../../alglin/files/monitoria7/" class="dropdown-item">Monitoria 7</a>
</li>
                                    
<li>
    <a href="../../../alglin/files/monitoria10/" class="dropdown-item">Monitorias 10 e 11</a>
</li>
                                    
<li>
    <a href="../../../alglin/files/monitoria12/" class="dropdown-item">Monitorias 12 e 13</a>
</li>
                                    
<li>
    <a href="../../../alglin/files/decompositionLU/" class="dropdown-item">Decomposição LU</a>
</li>
                                </ul>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="../../SamplingDistribution/SamplingDistribution/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../../BayesianAnalysisNormal/BayesianAnalysisNormal/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a href="https://lucasmoschen.github.io" class="nav-link">Página Inicial</a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="1"><a href="#intervalos-de-confianca" class="nav-link">Intervalos de Confiança</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#intervalo-de-confianca-para-a-media-de-nmu-sigma2" class="nav-link">Intervalo de Confiança para a média de N(\mu, \sigma^2)</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#interpretacao" class="nav-link">Interpretação</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#intervalos-de-confianca-unilateral" class="nav-link">Intervalos de Confiança Unilateral</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#intervalo-unilateral-para-a-media-de-nmusigma2" class="nav-link">Intervalo unilateral para a média de N(\mu,\sigma^2)</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#pivotal" class="nav-link">Pivotal</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#exemplo-com-regressao-linear" class="nav-link">Exemplo com Regressão Linear</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="intervalos-de-confianca">Intervalos de Confiança</h1>
<p>Esse tema procura responder quão confiança deveríamos por em um estimador. É claro que essa pergunta tem que ser um pouco melhor descrita matematicamente. A ideia é frequentista e tem a ideia a seguinte forma: </p>
<blockquote>
<p>O intervalo <script type="math/tex">[a,b]</script>, uma realização de <script type="math/tex">[A,B]</script>, tem 95% de confiança se em 95% do tempo, o parâmetro procurado está entre <script type="math/tex">a</script> e <script type="math/tex">b</script>. Veja que a ideia é basicamente frequentista, dado que a interpretação está ligada à frequência quando o número de experimentos tende para infinito. (Cuidado: Não vamos falar da probabilidade do parâmetro estar em <script type="math/tex">[a,b]</script>, isso não faz sentido, pois <script type="math/tex">\theta</script> não é uma variável aleatória, e sim um valor fixo).</p>
</blockquote>
<h3 id="definicao">Definição</h3>
<p>Seja <script type="math/tex">X_1, ..., X_n \overset{iid}{\sim} F(\theta)</script>. Sejam <script type="math/tex">A \leq B</script> duas estatísticas que possuem a propriedade, para todo <script type="math/tex">\theta</script>, </p>
<p>
<script type="math/tex; mode=display">
P(A < g(\theta) < B) \geq \gamma
</script>
</p>
<p>Chamamos <script type="math/tex">(A,B)</script> de intevalo de confiança para <script type="math/tex">g(\theta)</script> com coeficiente <script type="math/tex">\gamma</script>. O intervalo é chamado de <strong>exato</strong> se ao invés da desigualdade, tivermos uma igualdade. </p>
<p>Após observarmos os valores de <script type="math/tex">X_1, ..., X_n</script> e computarmos <script type="math/tex">A = a</script> e <script type="math/tex">B = b</script>, o intervalo <script type="math/tex">(a,b)</script> é chamado de valor observado do intervalo de confiança. </p>
<h2 id="intervalo-de-confianca-para-a-media-de-nmu-sigma2">Intervalo de Confiança para a média de <script type="math/tex">N(\mu, \sigma^2)</script>
</h2>
<p>Seja <script type="math/tex">X_1, ..., X_n \sim N(\mu, \sigma^2)</script>. Para cada <script type="math/tex">0 < \gamma < 1</script>, o intervalo <script type="math/tex">(A,B)</script> é intervalo de confiança exato para <script type="math/tex">\mu</script> com coeficiente <script type="math/tex">\gamma</script>, em que:</p>
<p>
<script type="math/tex; mode=display">
A = \bar{X}_n - T_{n-1}^{-1}\left(\frac{1 + \gamma}{2}\right)\frac{\sigma '}{n^{1/2}}
</script>
<script type="math/tex; mode=display">
B = \bar{X}_n + T_{n-1}^{-1}\left(\frac{1 + \gamma}{2}\right)\frac{\sigma '}{n^{1/2}}
</script>
</p>
<p>onde <script type="math/tex">T_{n-1}</script> denota a cdf da distribuição <script type="math/tex">t</script> com <script type="math/tex">n-1</script> graus de liberdade. </p>
<p>O interessante é que isso é implicação direta da distribuição de <script type="math/tex">U = \frac{n^{1/2}(\bar{X}_n - \mu)}{\sigma '}</script> que inferimos no capítulo 8.4, nesse caso, simplemente fizemos a transformação:</p>
<p>
<script type="math/tex; mode=display">\gamma = P(-c < U < c) = P(A < \mu < B)</script>
</p>
<p>e <script type="math/tex">c</script> é escolhido de acordo com <script type="math/tex">\gamma</script>.</p>
<h3 id="implementacao">Implementação</h3>
<p>Vamos rever a informação sobre café que usamos capítulos antes para ver como isso acontece na prática.</p>
<p>Considere dados sobre pesos de bebês logo ao nascer. </p>
<ol>
<li>bwt: peso do bebê ao nascer. </li>
<li>gestation: duração em dias da gestação. </li>
<li>parity: primeiro filho ou não.</li>
<li>age: idade da mãe. </li>
<li>height: altura da mãe em polegadas. </li>
<li>weight: peso da mãe em pounds.  </li>
<li>smoke: se a mãe é fumante ou não. </li>
</ol>
<div class="highlight"><pre><span></span><code><span class="c1"># Importando bibliotecas </span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span> 
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="kn">as</span> <span class="nn">sns</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">t</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">birth_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;http://people.reed.edu/~jones/141/Bwt.dat&quot;</span><span class="p">)</span>
<span class="n">birth_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>bwt</th>
      <th>gestation</th>
      <th>parity</th>
      <th>age</th>
      <th>height</th>
      <th>weight</th>
      <th>smoke</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>120</td>
      <td>284</td>
      <td>0</td>
      <td>27</td>
      <td>62</td>
      <td>100</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>113</td>
      <td>282</td>
      <td>0</td>
      <td>33</td>
      <td>64</td>
      <td>135</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>128</td>
      <td>279</td>
      <td>0</td>
      <td>28</td>
      <td>64</td>
      <td>115</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>108</td>
      <td>282</td>
      <td>0</td>
      <td>23</td>
      <td>67</td>
      <td>125</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>136</td>
      <td>286</td>
      <td>0</td>
      <td>25</td>
      <td>62</td>
      <td>93</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>

<div class="highlight"><pre><span></span><code><span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">birth_df</span><span class="o">.</span><span class="n">bwt</span><span class="p">,</span> <span class="n">kde</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Histograma dos pesos dos bebês&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">birth_df</span><span class="p">[</span><span class="n">birth_df</span><span class="o">.</span><span class="n">smoke</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">bwt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">density</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Não fumante&#39;</span><span class="p">)</span>
<span class="n">birth_df</span><span class="p">[</span><span class="n">birth_df</span><span class="o">.</span><span class="n">smoke</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">bwt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">density</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Fumante&#39;</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Peso&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>
<p><img alt="png" src="../output_4_0.png" /></p>
<p><img alt="png" src="../output_4_1.png" /></p>
<p>Sabemos que essa é uma extração de uma população maior. Para conseguirmos mais amostras, vamos usar um procedimento chamado <strong>bootstrap</strong>. A ideia desse procedimento é criar um novas amostras a partir de uma amostra inicial, usando <code>replace = True</code> como diferencial. Vou fazer esse procedimento diversar vezes e ir calculando a média amostral. Como a média amostral é uma variável aleatória, vamos obter um histograma das realizações. </p>
<p>Vamos supor que o peso <script type="math/tex">W_i</script> da criança <script type="math/tex">i</script> vem de uma distribuição com parâmetros <script type="math/tex">\mu</script> e <script type="math/tex">\sigma^2</script> desconhecidos. Nesse caso, <script type="math/tex">\bar{W}_i</script> virá de uma distribuição normal com parâmetros <script type="math/tex">\mu</script> e <script type="math/tex">\sigma^2/n</script>. </p>
<div class="highlight"><pre><span></span><code><span class="n">ite</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">200</span>

<span class="n">bootstrap_means</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">ite</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ite</span><span class="p">):</span>
    <span class="n">bootstrap_sample</span> <span class="o">=</span> <span class="n">birth_df</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span> <span class="o">=</span> <span class="n">n</span><span class="p">,</span> <span class="n">replace</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>
    <span class="n">bootstrap_means</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">bootstrap_sample</span><span class="o">.</span><span class="n">bwt</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">bootstrap_means</span><span class="p">,</span> <span class="n">kde</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Médias das amostras&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Peso&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>
<p><img alt="png" src="../output_7_0.png" /></p>
<p>Vamos calcular o nosso intervalo de confiança com <script type="math/tex">\gamma = 0.95</script>. Temos que:</p>
<div class="highlight"><pre><span></span><code><span class="n">gamma</span> <span class="o">=</span> <span class="mf">0.95</span>

<span class="n">A</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">t</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">q</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">gamma</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">df</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">ddof</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="n">B</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">t</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">q</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">gamma</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">df</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">ddof</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">ite</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">500</span>

<span class="n">bootstrap_intervals</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">ite</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ite</span><span class="p">):</span>
    <span class="n">bootstrap_sample</span> <span class="o">=</span> <span class="n">birth_df</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span> <span class="o">=</span> <span class="n">n</span><span class="p">,</span> <span class="n">replace</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>
    <span class="n">bootstrap_intervals</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">A</span><span class="p">(</span><span class="n">bootstrap_sample</span><span class="o">.</span><span class="n">bwt</span><span class="p">)</span>
    <span class="n">bootstrap_intervals</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">B</span><span class="p">(</span><span class="n">bootstrap_sample</span><span class="o">.</span><span class="n">bwt</span><span class="p">)</span>

<span class="n">out_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">bootstrap_intervals</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">119.5</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">bootstrap_intervals</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">119.5</span><span class="p">))</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">bootstrap_intervals</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ite</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">bootstrap_intervals</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ite</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">bootstrap_intervals</span><span class="p">[</span><span class="n">out_values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">0</span><span class="p">],</span> <span class="n">out_values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Fora&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">bootstrap_intervals</span><span class="p">[</span><span class="n">out_values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">1</span><span class="p">],</span> <span class="n">out_values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="mf">119.5</span><span class="p">,</span> <span class="n">ymin</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="n">ite</span><span class="p">,</span> <span class="n">linestyle</span> <span class="o">=</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.6</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Média real&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>
<p><img alt="png" src="../output_11_0.png" /></p>
<h2 id="interpretacao">Interpretação</h2>
<p>Estamos fazer uma afirmação probabilística sobre o intervalo <script type="math/tex">(A,B)</script> antes de observar os dados. Após observarmos os dados, não podemos interpretar <script type="math/tex">(a,b)</script> como um intervalo em que temos 95% de confiança de <script type="math/tex">g(\theta)</script> estar no intervalo. Antes de observarmos as amostras, temos a confiança de que 95% dos intervalos conterão <script type="math/tex">\mu</script>. </p>
<h3 id="sem-simetria">Sem simetria</h3>
<p>Construimos anteriormente um intervalo simétrico, onde a estatística <script type="math/tex">U</script> acima mencionada estaria entre <script type="math/tex">-c</script> e <script type="math/tex">c</script> com probabilidade <script type="math/tex">\gamma</script>. Mas podemos desenvolver intervalos não simétricos também. Uma forma que podemos fazer isso é escolhendo <script type="math/tex">\gamma_1</script> e <script type="math/tex">\gamma_2</script>, tal que <script type="math/tex">\gamma_2 - \gamma_1 = \gamma</script>. Assim: </p>
<p>
<script type="math/tex; mode=display">P\left(T_{n-1}^{-1}(\gamma_1) < U < T_{n-1}^{-1}(\gamma_2)\right) = \gamma</script>
</p>
<p>Talvém vc esteja se perguntando: porque escolher <script type="math/tex">\gamma_1, \gamma_2</script> dessa forma? Bom: </p>
<p>
<script type="math/tex; mode=display">
\begin{split}
\gamma &= P\left(T_{n-1}^{-1}(\gamma_1) < U < T_{n-1}^{-1}(\gamma_2)\right) \\
&= P\left(U < T_{n-1}^{-1}(\gamma_2)\right) - P\left(U \leq T_{n-1}^{-1}(\gamma_1)\right) \\
&= \gamma_2 - \gamma_1
\end{split}
</script>
</p>
<h2 id="intervalos-de-confianca-unilateral">Intervalos de Confiança Unilateral</h2>
<h3 id="definicao_1">Definição</h3>
<p>Seja <script type="math/tex">X_1, ..., X_n \overset{idd}{\sim} F(\theta)</script>. Sejam <script type="math/tex">A</script> e <script type="math/tex">B</script> duas estatísticas tais que: </p>
<p>
<script type="math/tex; mode=display">
P(A < g(\theta)) \geq \gamma
</script>
</p>
<p>
<script type="math/tex; mode=display">
P(B > g(\theta)) \geq \gamma
</script>
</p>
<p>Então <script type="math/tex">(A, \infty)</script> e <script type="math/tex">(-\infty, B)</script> são chamados de intervalos de confiaça unilaterais para <script type="math/tex">g(\theta)</script> de coeficiente <script type="math/tex">\gamma</script> ou percentil <script type="math/tex">100\gamma</script>. No caso de <script type="math/tex">A</script>
<script type="math/tex">100\gamma</script> porcento abaixo e no caso de <script type="math/tex">B</script> a cima. Se vale a igualdade, dizemos que o intervalor é exato.  </p>
<h2 id="intervalo-unilateral-para-a-media-de-nmusigma2">Intervalo unilateral para a média de <script type="math/tex">N(\mu,\sigma^2)</script>
</h2>
<p>Nas mesma condições do teorema anterior, mas as estatísticas para baixo e para cima com coeficiente <script type="math/tex">\gamma</script> para <script type="math/tex">\mu</script> são: </p>
<p>
<script type="math/tex; mode=display">
A = \bar{X}_n - T_{n-1}^{-1}\left(\gamma\right)\frac{\sigma '}{n^{1/2}}
</script>
<script type="math/tex; mode=display">
B = \bar{X}_n + T_{n-1}^{-1}\left(\gamma\right)\frac{\sigma '}{n^{1/2}}
</script>
</p>
<h2 id="pivotal">Pivotal</h2>
<p>Seja <script type="math/tex">X_1, ..., X_n \overset{idd}{\sim} F(\theta)</script>. Seja <script type="math/tex">V(\vec{X},\theta)</script> uma variável aleatória cuja distribuição é a mesma para <script type="math/tex">\theta</script>. Chamamos <script type="math/tex">V</script> de <strong>quantidade pivotal</strong>. </p>
<h3 id="teorema">Teorema</h3>
<p>Seja <script type="math/tex">X_1, ..., X_n \overset{idd}{\sim} F(\theta)</script>. Suponha que </p>
<ol>
<li>Exista <script type="math/tex">V</script> pivotal. </li>
<li>A cdf <script type="math/tex">G</script> de <script type="math/tex">V</script> é contínua. </li>
<li>Exista função <script type="math/tex">r</script> tal <script type="math/tex">r(V(X,\theta), X) = g(\theta)</script>, ou seja, é uma espécie de "inversa". </li>
<li>
<script type="math/tex">r(v,x)</script> (3) é uma função estritamente crescente em <script type="math/tex">v</script> para todo <script type="math/tex">x</script>. </li>
</ol>
<p>Então </p>
<p>
<script type="math/tex; mode=display">
A = r(G^{-1}(\gamma_1), X)
</script>
<script type="math/tex; mode=display">
B = r(G^{-1}(\gamma_2), X)
</script>
</p>
<p>são os pontos extremos do intervalo de confiança exato para <script type="math/tex">g(\theta)</script> de coeficiente <script type="math/tex">\gamma = \gamma_2 - \gamma_1</script>. Se <script type="math/tex">r</script> é estritamente decrescente, invertemos <script type="math/tex">A</script> e <script type="math/tex">B</script>. </p>
<p><em>Obs.: Ainda podemos usar o Teorema Central do Limite para obter intervalos de confiança assintóticos.</em></p>
<h2 id="exemplo-com-regressao-linear">Exemplo com Regressão Linear</h2>
<p>O dataset que utilizei anteriormente não é muito bom para esse exemplo, mas eu vou usar, de qualquer forma, para entendermos o processo e como pode nos ajudar o intervalo de confiança. </p>
<p>Em uma Regressão Linear, queremos dizer aferir uma relação linear entre duas variáveis, isto é, queremos dizer que uma variável pode ser obtida pela outra através de uma reta, mais um erro aleatório. Suponha que queremos estimar <script type="math/tex">Y</script> o peso da criança ao nascer, sabendo a informação do tempo de gestação <script type="math/tex">X</script> e que </p>
<p>
<script type="math/tex; mode=display">
Y = aX + b + E,
</script>
</p>
<p>onde <script type="math/tex">E \sim N(0,\sigma^2)</script>. Nesse caso, estamos dizendo que <script type="math/tex">Y|X \sim N(aX + b, \sigma^2)</script>. Queremos estimar <script type="math/tex">a</script> e <script type="math/tex">b</script> de forma que tenhamos o melhor ajuste possível. Esse tema em específico não me interessa. Entretanto, podemos dizer que queremos estimar <script type="math/tex">aX + b</script>, a média de uma normal, mas que muda para cada <script type="math/tex">X = x</script> observado. </p>
<div class="highlight"><pre><span></span><code><span class="n">sns</span><span class="o">.</span><span class="n">lmplot</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;gestation&#39;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;bwt&#39;</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">birth_df</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">ci</span> <span class="o">=</span> <span class="mi">95</span><span class="p">)</span>
</code></pre></div>
<pre><code>&lt;seaborn.axisgrid.FacetGrid at 0x7fc517f55c18&gt;
</code></pre>
<p><img alt="png" src="../output_16_1.png" /></p>
<p>O resultado não foi muito bom (na verdade eu já imaginava isso). Mas o interessante é tentar refletir o que essas bandas significam? Por que os pontos não estão nela? Esperávamos que estivésse? E por que ela diminui a variância com o número de pontos? </p>
<p>Essas perguntas vão ser devidamente respondidas no próximo curso de Estatística!</p>
<p>Mas eu já vou adiantando que esse intervalo de confiança é para a média estimada. </p></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "../../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../../js/base.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML" defer></script>
        <script src="../../../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
